<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta property="og:type" content="website">
<meta property="og:title" content="温培方的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="温培方的博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="温培方的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title> 温培方的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">温培方的博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">青春时光转眼即逝</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/04/ios-password/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/08/04/ios-password/" itemprop="url">
                  仿支付宝密码框
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-04T18:50:50+08:00">
                2020-08-04
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="使用UIKeyInput实现"><a href="#使用UIKeyInput实现" class="headerlink" title="使用UIKeyInput实现"></a>使用UIKeyInput实现</h3><h4 id="UIKeyInput协议主要方法"><a href="#UIKeyInput协议主要方法" class="headerlink" title="UIKeyInput协议主要方法"></a>UIKeyInput协议主要方法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@protocol UIKeyInput &lt;UITextInputTraits&gt;</span><br><span class="line"></span><br><span class="line">- (BOOL)hasText;// A Boolean value that indicates whether the text-entry objects has any text. (required)YES</span><br><span class="line"> //if the backing store has textual content, NO otherwise. 官方文档的解释我也翻译不好 </span><br><span class="line">- (void)insertText:(NSString *)text;// 插入文本</span><br><span class="line">- (void)deleteBackward; // 键盘上的退格事件</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h3 id="简单实现"><a href="#简单实现" class="headerlink" title="简单实现"></a>简单实现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">@interface PasswordView : UIView&lt;UIKeyInput&gt;</span><br><span class="line">@property (nonatomic,assign)NSInteger maxLength;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">//  PasswordView.m</span><br><span class="line">//  Lock</span><br><span class="line">//</span><br><span class="line">//  Created by mac on 2020/8/4.</span><br><span class="line">//  Copyright © 2020 shandongwenyuan. All rights reserved.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &quot;PasswordView.h&quot;</span><br><span class="line">@interface PasswordView()</span><br><span class="line">@property (nonnull,strong)NSMutableString *textStore;</span><br><span class="line">@end</span><br><span class="line">@implementation PasswordView</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithCoder:(NSCoder *)coder</span><br><span class="line">&#123;</span><br><span class="line">    self = [super initWithCoder:coder];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        _maxLength = 6;</span><br><span class="line">        _textStore = [NSMutableString string];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithFrame:(CGRect)frame</span><br><span class="line">&#123;</span><br><span class="line">    self = [super initWithFrame:frame];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        _maxLength = 6;</span><br><span class="line">        _textStore = [NSMutableString string];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(BOOL)hasText&#123;</span><br><span class="line">    return self.textStore.length&gt;0;</span><br><span class="line">&#125;</span><br><span class="line">- (void)insertText:(NSString *)text&#123;</span><br><span class="line">    if(self.textStore.length &lt; self.maxLength)&#123;</span><br><span class="line">        [self.textStore appendString:text];</span><br><span class="line">        [self setNeedsDisplay];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">- (void)deleteBackward&#123;</span><br><span class="line">     if (self.textStore.length &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">        [self.textStore deleteCharactersInRange:NSMakeRange(self.textStore.length - 1, 1)];</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      [self setNeedsDisplay];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (BOOL)canBecomeFirstResponder&#123;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UIKeyboardType)keyboardType&#123;</span><br><span class="line">    return UIKeyboardTypePhonePad;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Only override drawRect: if you perform custom drawing.</span><br><span class="line">// An empty implementation adversely affects performance during animation.</span><br><span class="line">- (void)drawRect:(CGRect)rect &#123;</span><br><span class="line">    // Drawing code</span><br><span class="line">    </span><br><span class="line">    CGFloat width = rect.size.width;</span><br><span class="line">    CGFloat height = rect.size.height;</span><br><span class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</span><br><span class="line">    CGContextSetFillColorWithColor(context, RGB(0xf7f7f7).CGColor);</span><br><span class="line">    CGFloat item_width = (width-10*self.maxLength-1)/self.maxLength;</span><br><span class="line">    for (int i = 0; i &lt; self.maxLength; i++) &#123;</span><br><span class="line">        //画边框</span><br><span class="line">        CGContextFillRect(context, CGRectMake(i*(item_width+10), 0, item_width, height));</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    CGContextSetFillColorWithColor(context,[UIColor blackColor].CGColor);</span><br><span class="line"></span><br><span class="line">    for (int  i = 0; i &lt; self.textStore.length; i++) &#123;</span><br><span class="line">        </span><br><span class="line">        CGContextAddArc(context,i*(item_width+10)+item_width/2.0, height/2.0, 5, 0, M_PI*2, YES);</span><br><span class="line">        CGContextDrawPath(context, kCGPathFill);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/13/js-compile/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/04/13/js-compile/" itemprop="url">
                  javaScript预编译
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-13T14:09:51+08:00">
                2019-04-13
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="js预编译"><a href="#js预编译" class="headerlink" title="js预编译"></a>js预编译</h2><h3 id="预编译过程-发生在函数执行的前一刻"><a href="#预编译过程-发生在函数执行的前一刻" class="headerlink" title="预编译过程 发生在函数执行的前一刻"></a>预编译过程 发生在函数执行的前一刻</h3><p>步骤：<br></p>
<ol>
<li>创建AO对象 activation object(执行期上下文as作用域)</li>
<li>找形参和变量声明，将变量和形参名作为AO的属性名,值为undefined</li>
<li>将实参和形参统一</li>
<li>在函数体里找函数声明,把函数名当属性，值为函数体</li>
</ol>
<h2 id="例子讲解"><a href="#例子讲解" class="headerlink" title="例子讲解"></a>例子讲解</h2><p>代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;    </span><br><span class="line">       function fn(a)&#123;</span><br><span class="line">           console.log(a)   //func</span><br><span class="line">           var a = 123;</span><br><span class="line">           console.log(a)   // 123</span><br><span class="line"></span><br><span class="line">           function a()&#123;&#125;</span><br><span class="line">           console.log(a)  //123</span><br><span class="line"></span><br><span class="line">           var b = function()&#123;&#125;</span><br><span class="line">           console.log(b)     // func</span><br><span class="line">           function d()&#123;&#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       fn(1)</span><br><span class="line">   &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>编译过程</p>
<ol>
<li><p>创建AO对象   </p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AO=&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>找形参和变量声明,并复制undefined 有形参a 及变量 a,b</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AO=&#123;</span><br><span class="line">	a: undefined</span><br><span class="line">	b: undefined</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将实参和形参统一</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">AO=&#123;</span><br><span class="line">	a: 1</span><br><span class="line">	b: undefined</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在函数体里找函数声明 有a d</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AO=&#123;</span><br><span class="line">	a: function a()&#123;&#125;</span><br><span class="line">	b: undefined</span><br><span class="line">	d: function d()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>所以打印结果为<br>function 123 123  function</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/09/css-priority/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/04/09/css-priority/" itemprop="url">
                  css优先级
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-09T11:45:46+08:00">
                2019-04-09
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="css权重"><a href="#css权重" class="headerlink" title="css权重"></a>css权重</h2><ul>
<li>!important: Infinity</li>
<li>行间样式:1000</li>
<li>id:100</li>
<li>class|属性|伪类:10</li>
<li>标签|伪元素:1</li>
<li>通配符:0</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span>&#123;<span class="attribute">color</span>: yellow;&#125;   <span class="comment">/*0001*/</span></span><br><span class="line"><span class="selector-tag">div</span> <span class="selector-tag">a</span>&#123;<span class="attribute">color</span>: green;&#125;  <span class="comment">/*0001+0001 =  0002*/</span></span><br><span class="line"><span class="selector-class">.demo</span> <span class="selector-tag">a</span>&#123;<span class="attribute">color</span>: black;&#125;   <span class="comment">/* 0010 + 0001 = 0011 */</span></span><br><span class="line"><span class="selector-class">.demo</span> <span class="selector-tag">input</span><span class="selector-attr">[type="text"]</span>&#123;<span class="attribute">color</span>: blue;&#125; <span class="comment">/*0010+0001+0010 = 0021*/</span></span><br><span class="line"><span class="selector-class">.demo</span> *<span class="selector-attr">[type="text"]</span>&#123;<span class="attribute">color</span>: grey;&#125; <span class="comment">/*0010+0+0010 = 0020*/</span></span><br><span class="line"><span class="selector-id">#demo</span> <span class="selector-tag">a</span>&#123;<span class="attribute">color</span>: orange;&#125; <span class="comment">/*0100+0001 = 0101*/</span></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#demo</span> <span class="selector-tag">a</span>&#123;<span class="attribute">color</span>: red;&#125; <span class="comment">/*0001+0100+0001 = 0102*/</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/progress-md/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/15/progress-md/" itemprop="url">
                  仿淘宝进度条
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T18:51:16+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="IOS-仿淘宝-淘抢购进度条"><a href="#IOS-仿淘宝-淘抢购进度条" class="headerlink" title="IOS 仿淘宝 淘抢购进度条"></a>IOS 仿淘宝 淘抢购进度条</h1><h2 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h2><p><img src="https://github.com/wpfcool/taobaoprogress/blob/master/image/git.gif?raw=true" alt="image"></p>
<p><a href="https://github.com/wpfcool/taobaoprogress" target="_blank" rel="noopener">源码</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/17/视差效果/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/17/视差效果/" itemprop="url">
                  视差效果
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-17T14:56:18+08:00">
                2017-05-17
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>iOS7以后增加视差效果，可通过UIInterpolatingMotionEffect类实现此效果。</p>
<blockquote>
<p><strong>keyPath</strong>:左右翻转屏幕将要影响到的属性，比如center.x。<br><strong>type</strong>:（UIInterpolatingMotionEffectType类型）<br><strong>minimumRelativeValue</strong>和<strong>maximumRelativeValue</strong>:注意这个是id类型。视差的范围.</p>
</blockquote>
<p>代码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">UIInterpolatingMotionEffect *horizontalEffect = [[UIInterpolatingMotionEffect alloc] initWithKeyPath:@&quot;center.x&quot;</span><br><span class="line">       type:UIInterpolatingMotionEffectTypeTiltAlongHorizontalAxis];</span><br><span class="line">   horizontalEffect.minimumRelativeValue = @(-kCustomIOS7MotionEffectExtent);</span><br><span class="line">   horizontalEffect.maximumRelativeValue = @( kCustomIOS7MotionEffectExtent);</span><br><span class="line">   UIInterpolatingMotionEffect *verticalEffect = [[UIInterpolatingMotionEffect alloc] initWithKeyPath:@&quot;center.y&quot; type:UIInterpolatingMotionEffectTypeTiltAlongVerticalAxis];</span><br><span class="line">   verticalEffect.minimumRelativeValue = @(-kCustomIOS7MotionEffectExtent);</span><br><span class="line">   verticalEffect.maximumRelativeValue = @( kCustomIOS7MotionEffectExtent);</span><br><span class="line"></span><br><span class="line">   UIMotionEffectGroup *motionEffectGroup = [[UIMotionEffectGroup alloc] init];</span><br><span class="line">   motionEffectGroup.motionEffects = @[horizontalEffect, verticalEffect];</span><br><span class="line"></span><br><span class="line">   [view addMotionEffect:motionEffectGroup];</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/01/ios123/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/01/ios123/" itemprop="url">
                  UIButton 的纵向排列
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-01T17:08:45+08:00">
                2017-03-01
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">UIButton * tempButton = [UIButton buttonWithType:UIButtonTypeCustom];</span><br><span class="line">[tempButton setTitle:@&quot;测试数据&quot; forState:UIControlStateNormal];</span><br><span class="line">tempButton.frame = CGRectMake(25, 100, 200, 100);</span><br><span class="line">tempButton.backgroundColor = [UIColor redColor];</span><br><span class="line">tempButton.titleLabel.font = [UIFont systemFontOfSize:14];</span><br><span class="line">tempButton.titleLabel.textAlignment = NSTextAlignmentLeft;</span><br><span class="line">[tempButton setImage:[UIImage imageNamed:@&quot;feed_unSelected&quot;] forState:UIControlStateNormal];</span><br><span class="line"></span><br><span class="line">CGFloat imageoffsety = tempButton.imageView.frame.size.height/2.0; //图片向上移动图片一般的高度</span><br><span class="line">CGFloat imageoffsetx = (tempButton.imageView.frame.size.width + tempButton.titleLabel.frame.size.width)/2.0 - tempButton.imageView.frame.size.width/2.0; //图片向右移动图片宽度和文字实际宽度的一半 减去 图片一半的宽度</span><br><span class="line">CGFloat titley =tempButton.titleLabel.frame.size.height/2.0; //文字 想下移动文字一般的距离</span><br><span class="line">CGFloat titlex = (tempButton.titleLabel.intrinsicContentSize.width + tempButton.imageView.frame.size.width)/2.0 - tempButton.titleLabel.intrinsicContentSize.width/2.0;//文字向左移动图片宽度和文字实际宽度的一半 减去 文字一半的宽度</span><br><span class="line">tempButton.titleEdgeInsets = UIEdgeInsetsMake(titley, -titlex, -titley, titlex);</span><br><span class="line">tempButton.imageEdgeInsets = UIEdgeInsetsMake(-imageoffsety ,imageoffsetx,imageoffsety, -imageoffsetx);</span><br><span class="line">[self.view addSubview:tempButton];</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/11/runtime-02/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/11/runtime-02/" itemprop="url">
                  runtime 方法调用及转发
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-11T16:05:19+08:00">
                2017-01-11
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="方法调用"><a href="#方法调用" class="headerlink" title="方法调用"></a>方法调用</h1><p>如果用实例对象调用实例方法，会到实例isa指针指向的对象（类对象）操作<br>如果调用的是类方法，就会到类对象的isa指针指向的对象（元类对象）中操作</p>
<h2 id="方法调用过程"><a href="#方法调用过程" class="headerlink" title="方法调用过程"></a>方法调用过程</h2><ol>
<li>首先，在相应操作的对象中的缓存方法列表中找到调用的方法，如果找到，转向相应实现并执行</li>
<li>如果没找到，在相应操作的对象中的方法列表中找到调用方法，如果找到，转向相应实现执行</li>
<li>如果没找到，去父类指针所指向的对象中执行1，2操作</li>
<li>以此类推，如果一直到跟类没有找到，转向拦截调用</li>
<li>如果没有重写拦截调用的方法，程序报错</li>
</ol>
<h2 id="拦截调用"><a href="#拦截调用" class="headerlink" title="拦截调用"></a>拦截调用</h2><p>在找不到调用方法程序崩溃之前，重写一下四个方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+(BOOL)resolveInstanceMethod:(SEL)sel;</span><br><span class="line">+(BOOL)resolveClassMethod:(SEL)sel;</span><br><span class="line">-(void)forwardInvocation:(NSInvocation *)anInvocation;</span><br><span class="line">-(id)forwardingTargetForSelector:(SEL)aSelector;</span><br></pre></td></tr></table></figure></p>
<p>第一个方法，当调用不存在的实例方法时调用<br>第二个方法，当调用不存在的类方法时调用<br>第三个个方法是将你调用的不存在的方法打包成NSInvocation传给你，做完自己的处理后调用invokeWithTarget:方法让某个target触发这个方法<br>第四个个方法当你调用不存在的方法重新定向其他声明这个方法的类，只需返回这个方法的target  </p>
<h2 id="动态添加方法"><a href="#动态添加方法" class="headerlink" title="动态添加方法"></a>动态添加方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class_addMethod(&lt;#__unsafe_unretained Class cls#&gt;, &lt;#SEL name#&gt;, &lt;#IMP imp#&gt;, &lt;#const char *types#&gt;)</span><br></pre></td></tr></table></figure>
<p>其中class_addMethod的四个参数分别是：</p>
<ol>
<li>Class cls<br>给哪个类添加方法，本例中是self</li>
<li>SEL name<br>添加的方法，本例中是重写的拦截调用传进来的selector。</li>
<li>IMP imp<br>方法的实现，C方法的方法实现可以直接获得。如果是OC方法，可以用+ (IMP)instanceMethodForSelector:(SEL)aSelector;获得方法的实现。</li>
<li>“v@:*”方法的签名，代表有一个参数的方法。  </li>
</ol>
<p><a href="https://github.com/wpfcool/runtime" target="_blank" rel="noopener">DEMO:runtime_02</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/11/runtime-01/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/11/runtime-01/" itemprop="url">
                  runtime
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-11T15:48:34+08:00">
                2017-01-11
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="runtime-是什么"><a href="#runtime-是什么" class="headerlink" title="runtime 是什么"></a>runtime 是什么</h2><p>我们写的代码在程序运行过程中都会被转化成runtime的C代码执行</p>
<h1 id="定义一个类Person"><a href="#定义一个类Person" class="headerlink" title="定义一个类Person"></a>定义一个类Person</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Person.h</span><br><span class="line"></span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">@interface Person : NSObject</span><br><span class="line">&#123;</span><br><span class="line">NSString * birthday;</span><br><span class="line">&#125;</span><br><span class="line">@property (nonatomic,copy)NSString * name;</span><br><span class="line">@property (nonatomic,assign) NSInteger age;</span><br><span class="line"></span><br><span class="line">-(void)eat;</span><br><span class="line">-(void)sayHello;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">person.m</span><br><span class="line"></span><br><span class="line">#import &quot;Person.h&quot;</span><br><span class="line"></span><br><span class="line">@interface Person()</span><br><span class="line">&#123;</span><br><span class="line">NSInteger weight;</span><br><span class="line">&#125;</span><br><span class="line">@property(nonatomic,assign)NSInteger height;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation Person</span><br><span class="line">-(void)eat</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(void)sayHello</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">-(void)sleep</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>runtime 获得数据成员方法 class_copyIvarList（Class cls, unsigned int *outCount）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">unsigned int count = 0;</span><br><span class="line">Ivar * ivars = class_copyIvarList([Person class], &amp;count);</span><br><span class="line"></span><br><span class="line">for (int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">Ivar var = ivars[i];</span><br><span class="line">const char * name = ivar_getName(var);</span><br><span class="line">const char * type = ivar_getTypeEncoding(var);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;name:%s type:%s&quot;,name,type);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果  : </p>
<p>name:birthday type:@”NSString”<br>name:weight type:q<br>name:_name type:@”NSString”<br>name:_age type:q<br>name:_height type:q  </p>
<ol>
<li>runtime 获得property class_copyPropertyList(Class cls, unsigned int *outCount)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">unsigned propertyCount = 0;</span><br><span class="line">objc_property_t * pro =   class_copyPropertyList([Person class], &amp;propertyCount);</span><br><span class="line">for (int i = 0;  i &lt; propertyCount; i++) &#123;</span><br><span class="line"></span><br><span class="line">const char * name =  property_getName(pro[i]);</span><br><span class="line">NSLog(@&quot;name--&gt;%s&quot;,name);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果<br>name–&gt;height<br>name–&gt;name<br>name–&gt;age</p>
<ol>
<li>获取方法列表  class_copyMethodList(Class cls, unsigned int *outCount)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">unsigned methodCount = 0;</span><br><span class="line">Method * methods =  class_copyMethodList([Person class], &amp;methodCount);</span><br><span class="line">for (int  i = 0; i &lt; methodCount; i++) &#123;</span><br><span class="line">Method  method = methods[i];</span><br><span class="line">SEL sel = method_getName(method);</span><br><span class="line">const char * name = sel_getName(sel);</span><br><span class="line">NSLog(@&quot;%s&quot;,name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果：<br>eat<br>sayHello<br>sleep<br>age<br>setAge:<br>.cxx_destruct<br>name<br>setName:<br>height<br>setHeight:  </p>
<ol>
<li>获得协议列表</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">unsigned protocolCount = 0;</span><br><span class="line">__unsafe_unretained Protocol ** protocolList = class_copyProtocolList([Person class], &amp;protocolCount);</span><br><span class="line">for (int  i = 0; i &lt; protocolCount; i++) &#123;</span><br><span class="line">Protocol * myPrototcl = protocolList[i];</span><br><span class="line">NSLog(@&quot;%s&quot;,protocol_getName(myPrototcl));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/wpfcool/runtime" target="_blank" rel="noopener">DEMO:Runtime_01</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/06/关联对象存放自定义数据/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/06/关联对象存放自定义数据/" itemprop="url">
                  runtime关联对象
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-06T15:02:21+08:00">
                2016-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="在既有类中使用关联对象存放自定义数据"><a href="#在既有类中使用关联对象存放自定义数据" class="headerlink" title="在既有类中使用关联对象存放自定义数据"></a>在既有类中使用关联对象存放自定义数据</h1><p>在OC中可以给对象关联许多其他对象，这些对象通过“键”来区分。存储对象值得时候可以指明“存储策略”，用以维护相应的“内存管理语义”。存储策略有名为 objc_AssociationPolicy的枚举定义。</p>
<table>
<thead>
<tr>
<th>管理类型</th>
<th style="text-align:center">等效的@property属性</th>
</tr>
</thead>
<tbody>
<tr>
<td>OBJC_ASSOCIATION_ASSIGN</td>
<td style="text-align:center">assign</td>
</tr>
<tr>
<td>OBJC_ASSOCIATION_RETAIN_NONATOMIC</td>
<td style="text-align:center">nonatomic    retain</td>
</tr>
<tr>
<td>OBJC_ASSOCIATION_COPY_NONATOMIC</td>
<td style="text-align:center">nonatomic copy</td>
</tr>
<tr>
<td>OBJC_ASSOCIATION_RETAIN</td>
<td style="text-align:center">retain</td>
</tr>
<tr>
<td>OBJC_ASSOCIATION_COPY</td>
<td style="text-align:center">copy</td>
</tr>
</tbody>
</table>
<p>下列方法可以管理管理对象</p>
<ul>
<li>已给定的键和策略为某个对象设置关联对象值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void objc_setAssociatedObject(id object, const void *key, id value, objc_AssociationPolicy policy)</span><br></pre></td></tr></table></figure>
<ul>
<li>根据给定的键从某对象中获取相应的关联对象值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objc_getAssociatedObject(id object, const void *key)</span><br></pre></td></tr></table></figure>
<ul>
<li>移除指定对象的全部关联值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void objc_removeAssociatedObjects(id object)</span><br></pre></td></tr></table></figure>
<h3 id="代码例子"><a href="#代码例子" class="headerlink" title="代码例子"></a>代码例子</h3><p>为UIAlertView 管理一个block</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">static void * MYALERTKEY = &quot;EOALERT&quot;;</span><br><span class="line">-(void)buttonClick:(id)sender</span><br><span class="line">&#123;</span><br><span class="line">    UIAlertView * alert = [[UIAlertView alloc]initWithTitle:@&quot;title&quot; message:@&quot;message&quot; delegate:self cancelButtonTitle:@&quot;取消&quot; otherButtonTitles:@&quot;确定&quot;, nil];</span><br><span class="line">    </span><br><span class="line">    void (^block)(NSInteger) = ^(NSInteger index)&#123;</span><br><span class="line">        </span><br><span class="line">        if(index == 0)</span><br><span class="line">        &#123;</span><br><span class="line">            NSLog(@&quot;00000&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else if (index == 1)</span><br><span class="line">        &#123;</span><br><span class="line">            NSLog(@&quot;111&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;;</span><br><span class="line">    objc_setAssociatedObject(alert, MYALERTKEY, block, OBJC_ASSOCIATION_COPY);</span><br><span class="line">    [alert show];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex</span><br><span class="line">&#123;</span><br><span class="line">     void(^block)(NSInteger) = objc_getAssociatedObject(alertView, MYALERTKEY);</span><br><span class="line">    </span><br><span class="line">    block(buttonIndex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/03/d3Touch/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="温培方">
    <meta itemprop="description" content>
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="温培方的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="温培方的博客" src>
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/03/d3Touch/" itemprop="url">
                  3dTouch
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-05-03T14:06:29+08:00">
                2016-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Getting-start"><a href="#Getting-start" class="headerlink" title="Getting start"></a>Getting start</h1><h2 id="Home-screen-quick-actions"><a href="#Home-screen-quick-actions" class="headerlink" title="Home screen quick actions"></a>Home screen quick actions</h2><p>3D Touch 能够在Home界面的图标上，通过按压在图标的周围显示一个快捷操作（shortcuts）的菜单，通过这个菜单，我们能够更加快速直接的进入某项功能。<br>如</p>
<p><img src="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/Adopting3DTouchOniPhone/Art/maps_directions_home_2x.png" alt></p>
<p>这种快捷操作（shortcuts）分两种：</p>
<ul>
<li>Static shortcuts 静态的，在Info.plist里面配置，在程序安装后就会存在。</li>
<li>Dynamic shortcuts 动态的，在运行时创建的，直到程序第一次运行后才会存在。</li>
</ul>
<h3 id="Static-shortcuts"><a href="#Static-shortcuts" class="headerlink" title="Static shortcuts"></a>Static shortcuts</h3><p>1、 在Info.plist 进行配置 UIApplicationShortcutItems</p>
<p><img src="https://developer.apple.com/library/ios/documentation/General/Reference/InfoPlistKeyReference/Art/UIApplicationShortcutItems_plist_editor_2x.png" alt></p>
<p>2、 实现对应的点击事件<br>在Appdelegate.m中实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-(void)application:(UIApplication *)application performActionForShortcutItem:(UIApplicationShortcutItem *)shortcutItem completionHandler:(void (^)(BOOL))completionHandler</span><br><span class="line">&#123;</span><br><span class="line">    completionHandler(YES);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Dynamic-shortcuts"><a href="#Dynamic-shortcuts" class="headerlink" title="Dynamic shortcuts"></a>Dynamic shortcuts</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UIMutableApplicationShortcutItem * itme = [[UIMutableApplicationShortcutItem alloc]initWithType:@&quot;com.yc-ai.Touch3D.sousuo&quot; localizedTitle:@&quot;搜索&quot;];</span><br><span class="line">        </span><br><span class="line">application.shortcutItems = @[itme];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Keys for Home screen quick actions, also known as shortcut items</p>
<p>UIApplicationShortcutItemType(required)  必须的key 用于区分quick actions<br>UIApplicationShortcutItemTitle(required) 用于显示名称<br>UIApplicationShortcutItemSubtitle        用于显示子标题<br>UIApplicationShortcutItemIconType        图标类型</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">typedef enum UIApplicationShortcutIconType : NSInteger &#123;</span><br><span class="line">   UIApplicationShortcutIconTypeCompose,</span><br><span class="line">   UIApplicationShortcutIconTypePlay,</span><br><span class="line">   UIApplicationShortcutIconTypePause,</span><br><span class="line">   UIApplicationShortcutIconTypeAdd,</span><br><span class="line">   UIApplicationShortcutIconTypeLocation,</span><br><span class="line">   UIApplicationShortcutIconTypeSearch,</span><br><span class="line">   UIApplicationShortcutIconTypeShare,</span><br><span class="line">   UIApplicationShortcutIconTypeProhibit,</span><br><span class="line">   UIApplicationShortcutIconTypeContact,</span><br><span class="line">   UIApplicationShortcutIconTypeHome,</span><br><span class="line">   UIApplicationShortcutIconTypeMarkLocation,</span><br><span class="line">   UIApplicationShortcutIconTypeFavorite,</span><br><span class="line">   UIApplicationShortcutIconTypeLove,</span><br><span class="line">   UIApplicationShortcutIconTypeCloud,</span><br><span class="line">   UIApplicationShortcutIconTypeInvitation,</span><br><span class="line">   UIApplicationShortcutIconTypeConfirmation,</span><br><span class="line">   UIApplicationShortcutIconTypeMail,</span><br><span class="line">   UIApplicationShortcutIconTypeMessage,</span><br><span class="line">   UIApplicationShortcutIconTypeDate,</span><br><span class="line">   UIApplicationShortcutIconTypeTime,</span><br><span class="line">   UIApplicationShortcutIconTypeCapturePhoto,</span><br><span class="line">   UIApplicationShortcutIconTypeCaptureVideo,</span><br><span class="line">   UIApplicationShortcutIconTypeTask,</span><br><span class="line">   UIApplicationShortcutIconTypeTaskCompleted,</span><br><span class="line">   UIApplicationShortcutIconTypeAlarm,</span><br><span class="line">   UIApplicationShortcutIconTypeBookmark,</span><br><span class="line">   UIApplicationShortcutIconTypeShuffle,</span><br><span class="line">   UIApplicationShortcutIconTypeAudio,</span><br><span class="line">   UIApplicationShortcutIconTypeUpdate </span><br><span class="line">&#125; UIApplicationShortcutIconType;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>UIApplicationShortcutItemIconFile 自定义图片文件 <strong><em>icons should be square, single color, and 35x35 points</em></strong><br>UIApplicationShortcutItemUserInfo 设置字典信息用于传值</p>
</blockquote>
<h2 id="Peeking-and-popping"><a href="#Peeking-and-popping" class="headerlink" title="Peeking and popping"></a>Peeking and popping</h2><h2 id="在列表页面"><a href="#在列表页面" class="headerlink" title="在列表页面"></a>在列表页面</h2><ul>
<li>注册代理</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self registerForPreviewingWithDelegate:self sourceView:self.view];</span><br></pre></td></tr></table></figure>
<ul>
<li>实现UIViewControllerPreviewingDelegate代理</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">- (nullable UIViewController *)previewingContext:(id &lt;UIViewControllerPreviewing&gt;)previewingContext viewControllerForLocation:(CGPoint)location</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">   CGPoint  pp =  [self.view convertPoint:location toView:_tableView];</span><br><span class="line">    NSIndexPath * indexPath = [_tableView indexPathForRowAtPoint:pp];</span><br><span class="line">    UITableViewCell * celll = [_tableView cellForRowAtIndexPath:indexPath];</span><br><span class="line">    NSLog(@&quot;%f----%f&quot;,celll.frame.origin.x,celll.frame.origin.y);</span><br><span class="line">    DetailViewController * detail = [[DetailViewController alloc]init];</span><br><span class="line">    detail.number =_list[indexPath.row];</span><br><span class="line">    previewingContext.sourceRect = [_tableView convertRect:celll.frame toView:self.view];;</span><br><span class="line">    </span><br><span class="line">    return detail;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">- (void)previewingContext:(id &lt;UIViewControllerPreviewing&gt;)previewingContext commitViewController:(UIViewController *)viewControllerToCommit&#123;</span><br><span class="line"></span><br><span class="line">    [self showViewController:viewControllerToCommit sender:self];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="在详情页面实现"><a href="#在详情页面实现" class="headerlink" title="在详情页面实现"></a>在详情页面实现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (NSArray&lt;id&lt;UIPreviewActionItem&gt;&gt; *)previewActionItems&#123;</span><br><span class="line">    </span><br><span class="line">    UIPreviewAction * shareAction = [UIPreviewAction actionWithTitle:@&quot;分享&quot; style:UIPreviewActionStyleDefault handler:^(UIPreviewAction * _Nonnull action, UIViewController * _Nonnull previewViewController) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    return @[shareAction];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Icon尺寸:</p>
<p>35x35 (1x)<br>70x70 (2x)<br>105x105 (3x)  </p>
</blockquote>
<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a><a href="https://github.com/wpfcool/3DTouch.git" target="_blank" rel="noopener">代码</a></h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="温培方">
          <p class="site-author-name" itemprop="name">温培方</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">温培方</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  

  




  
  

  

  

  

  


</body>
</html>
